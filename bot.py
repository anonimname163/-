import asyncio
import random
import os
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º .env —Ñ–∞–π–ª
load_dotenv()
API_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")

if not API_TOKEN:
    raise ValueError("‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω! –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ .env –µ—Å—Ç—å TELEGRAM_BOT_TOKEN")

bot = Bot(token=API_TOKEN)
dp = Dispatcher()

# ---- –ü—Ä–æ—Å—Ç–µ–π—à–∞—è –ª–æ–≥–∏–∫–∞ ----
replies = {
    "–ø—Ä–∏–≤–µ—Ç": [
        "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ —É —Ç–µ–±—è –¥–µ–ª–∞?",
        "–•–µ–π! –†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å!",
        "–ó–¥–∞—Ä–æ–≤–∞! –ß—Ç–æ –Ω–æ–≤–æ–≥–æ?"
    ],
    "–¥–µ–ª–∞": [
        "–û—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ —á—Ç–æ —Å–ø—Ä–æ—Å–∏–ª!",
        "–í—Å—ë –Ω–æ—Ä–º, –∞ —É —Ç–µ–±—è?",
        "–ù–µ–ø–ª–æ—Ö–æ! –†–∞–¥, —á—Ç–æ –Ω–∞–ø–∏—Å–∞–ª."
    ],
    "–ø–æ–∫–∞": [
        "–ü–æ–∫–∞! –£–≤–∏–¥–∏–º—Å—è –ø–æ–∑–∂–µ üëã",
        "–î–æ –≤—Å—Ç—Ä–µ—á–∏!",
        "–ü—Ä–æ—â–∞–π, –¥—Ä—É–∂–∏—â–µ!"
    ],
    "–∫–∞–∫ —Ç—ã": [
        "–Ø –æ—Ç–ª–∏—á–Ω–æ! –°–ø–∞—Å–∏–±–æ üòä",
        "–ù–æ—Ä–º–∞–ª—å–Ω–æ, –∂–∏–≤—É –≤ —Ç–≤–æ—ë–º –∫–æ–¥–µ üòÑ",
        "–í—Å—ë —Å—É–ø–µ—Ä, —Ä–∞–±–æ—Ç–∞—é –ø–æ —à–∞–±–ª–æ–Ω—É!"
    ],
    "—Å–ø–∞—Å–∏–±–æ": [
        "–í—Å–µ–≥–¥–∞ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ üòå",
        "–ù–µ –∑–∞ —á—Ç–æ!",
        "–†–∞–¥ –ø–æ–º–æ—á—å!"
    ],
    "—Å–∫—É—á–∞–ª": [
        "–ö–æ–Ω–µ—á–Ω–æ —Å–∫—É—á–∞–ª üò¢",
        "–ù–µ–º–Ω–æ–≥–æ... –ù–æ —Ç–µ–ø–µ—Ä—å —Ç—ã —Ç—É—Ç!",
        "–°–∫—É—á–∞–ª, –Ω–æ —Ä–∞–¥ —Å–Ω–æ–≤–∞ –æ–±—â–∞—Ç—å—Å—è!"
    ]
}


@dp.message()
async def handle_message(message: types.Message):
    text = message.text.lower().strip()

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ª–∏ —Å "–°–°–ö"
    if text.startswith("—Å—Å–∫"):
        user_text = text[3:].strip()

        for key, variants in replies.items():
            if key in user_text:
                await message.answer(random.choice(variants))
                return

        # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–æ–≤–ø–∞–ª–æ
        await message.answer("–Ø —Ç–µ–±—è –ø–æ–Ω—è–ª, –Ω–æ –ø–æ–∫–∞ –Ω–µ –∑–Ω–∞—é, —á—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç—å üòÖ")

    elif text.startswith("/start"):
        await message.answer("–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç-—à–∞–±–ª–æ–Ω ü§ñ. –ü–∏—à–∏ '–°–°–ö' –∏ —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä:\n–°–°–ö –ø—Ä–∏–≤–µ—Ç")


async def main():
    print("‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ —Å–ª—É—à–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è...")
    await dp.start_polling(bot)


if __name__ == "__main__":
    asyncio.run(main())